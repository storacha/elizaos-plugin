{"version":3,"sources":["../src/actions/upload.ts","../src/environments.ts","../src/utils.ts","../src/clients/storage.ts","../src/actions/retrieve.ts","../src/index.ts"],"sourcesContent":["import { elizaLogger } from \"@elizaos/core\";\nimport {\n    type Action,\n    type ActionExample,\n    type HandlerCallback,\n    type IAgentRuntime,\n    type Memory,\n    type State,\n} from \"@elizaos/core\";\nimport fs from \"fs\";\nimport { validateStorageClientConfig } from \"../environments\";\nimport { defaultGatewayUrl } from \"../utils\";\nimport { createStorageClient } from \"../clients/storage\";\n\nexport const uploadAction: Action = {\n    name: \"STORAGE_UPLOAD\",\n    similes: [\"UPLOAD\", \"STORE\", \"SAVE\", \"PUT\", \"PIN\"],\n    description: \"Use this action when the user wants to upload a file to Storacha distributed storage network.\",\n    validate: async (runtime: IAgentRuntime) => {\n        await validateStorageClientConfig(runtime);\n        return true;\n    },\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state?: State,\n        options?: { [key: string]: unknown },\n        callback?: HandlerCallback\n    ) => {\n        const attachments = message.content.attachments;\n        if (attachments && attachments.length === 0) {\n            elizaLogger.error(\"No file to upload.\");\n            callback?.({\n                text: \"Looks like you didn't attach any files. Please attach a file and try again.\",\n                action: null\n            });\n            return false;\n        }\n\n        if (callback) {\n            await callback({\n                text: \"Sure thing! Starting the engines, hold on tight. Uploading file(s) to Storacha...\",\n                action: null\n            });\n        }\n        try {\n            elizaLogger.info(\"Uploading file(s) to Storacha...\");\n            const config = await validateStorageClientConfig(runtime);\n            const storageClient = await createStorageClient(config);\n            if (!storageClient) {\n                elizaLogger.error(\"Error initializing Storacha storage client\");\n                await callback?.({\n                    text: \"I'm sorry, I couldn't initialize the Storacha storage client. Please try again later.\",\n                    content: { error: \"Error initializing Storacha storage client\" },\n                });\n                return false;\n            }\n\n            const files = attachments.map(attached => {\n                const fileContent = fs.readFileSync(attached.url);\n                const blob = new Blob([fileContent], { type: attached.contentType, });\n                const file = new File([blob], attached.title, { type: attached.contentType });\n                return file;\n            })\n            const directoryLink = await storageClient.uploadDirectory(files, {\n                retries: 3,\n                concurrentRequests: 3,\n                pieceHasher: null, // Indicates to not store data in Filecoin\n                onUploadProgress: (progress) => {\n                    elizaLogger.info(`Uploading file(s) to Storacha... ${progress}%`);\n                }\n            })\n            const gatewayUrl = config.GATEWAY_URL || defaultGatewayUrl;\n            const link = `${gatewayUrl}/ipfs/${directoryLink.link().toString()}`;\n            elizaLogger.info(`Uploaded file(s) to Storacha. Link: ${link}`);\n            await callback?.({\n                text: `Here you go! You can access the file(s) at the following link: ${link}`,\n                action: null,\n            });\n\n            elizaLogger.success(\"File(s) uploaded to Storacha\");\n            return true;\n        } catch (error) {\n            elizaLogger.error(\"Error uploading file(s) to Storacha\", error);\n            await callback?.({\n                text: \"I'm sorry, I couldn't upload the file(s) to Storacha. Please try again later.\",\n                content: { error: error.message },\n            });\n            return false;\n        }\n    },\n    examples: [\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"can you upload this file?\",\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: \"I'll help you upload this file to a decentralized storage network.\",\n                    action: \"STORAGE_UPLOAD\"\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: `The files have been uploaded. You can access them at the following link: https://w3s.link/ipfs/QmHash1}`,\n                    action: null\n                },\n            }\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"store this document in Storacha please\",\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: \"I'll help you store that document in Storacha storage.\",\n                    action: \"STORAGE_UPLOAD\"\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: `The files have been uploaded. You can access them at the following link: https://w3s.link/ipfs/QmHash1}`,\n                    action: null\n                },\n            }\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"save this image for me\",\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: \"I'll help you save that image to Storacha storage.\",\n                    action: \"STORAGE_UPLOAD\"\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: `The image has been uploaded. You can access it at the following link: https://w3s.link/ipfs/QmHash1}`,\n                    action: null\n                },\n            }\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"pin this image into IPFS\",\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: \"I'll help you pin that image into IPFS using Storacha.\",\n                    action: \"STORAGE_UPLOAD\"\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: `The files have been pinned. You can access them at the following link: https://w3s.link/ipfs/QmHash1}`,\n                    action: null\n                },\n            }\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"pin this file into IPFS\",\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: \"I'll help you pin that file into IPFS using Storacha.\",\n                    action: \"STORAGE_UPLOAD\"\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: `The files have been pinned. You can access them at the following link: https://w3s.link/ipfs/QmHash1}`,\n                    action: null\n                },\n            }\n        ],\n    ] as ActionExample[][],\n} as Action;\n","import { IAgentRuntime, elizaLogger } from \"@elizaos/core\";\nimport { z } from \"zod\";\n\nexport const storageClientEnvSchema = z.object({\n    STORACHA_AGENT_PRIVATE_KEY: z.string()\n        .min(1, \"Storacha agent private key is required\")\n        .describe(`The private key of the agent that is used to sign data before uploading to the Storacha network.\n                  This is the base64 encoded private key string.\n                  You can install and sign up for a Storacha account using the CLI https://docs.storacha.network/w3cli\n                  And then create a private key for your agent:\n                  - https://github.com/storacha/upload-service/blob/main/packages/cli/README.md#storacha-agent-create-private-key`),\n\n    STORACHA_AGENT_DELEGATION: z.string()\n        .min(1, \"Storacha agent delegation is required\")\n        .describe(`The delegation that authorizes the Agent to upload data to the Storacha network.\n                  This is the base64 encoded delegation string.\n                  You can install and sign up for a Storacha account using the CLI https://docs.storacha.network/w3cli\n                  And then create a delegation for your agent:\n                  - https://docs.storacha.network/concepts/ucan/#delegate-across-apps-and-services\n                  - https://github.com/storacha/upload-service/blob/main/packages/cli/README.md#storacha-delegation-create-audience-did`),\n\n    GATEWAY_URL: z.string().nullable()\n        .default(\"https://w3s.link\")\n        .describe(\"The gateway URL to use for fetching data from the network. Defaults to https://w3s.link\"),\n});\n\nexport type StorageClientConfig = z.infer<typeof storageClientEnvSchema>;\n\nexport async function validateStorageClientConfig(\n    runtime: IAgentRuntime\n): Promise<StorageClientConfig> {\n    try {\n        const config = {\n            STORACHA_AGENT_PRIVATE_KEY: runtime.getSetting(\"STORACHA_AGENT_PRIVATE_KEY\"),\n            STORACHA_AGENT_DELEGATION: runtime.getSetting(\"STORACHA_AGENT_DELEGATION\"),\n            GATEWAY_URL: runtime.getSetting(\"GATEWAY_URL\"),\n        };\n        const c = storageClientEnvSchema.parse(config);\n        return c;\n    } catch (error) {\n        elizaLogger.error(\"Storage client config validation failed\", error);\n        if (error instanceof z.ZodError) {\n            const errorMessages = error.errors\n                .map((err) => `${err.path.join(\".\")}: ${err.message}`)\n                .join(\"\\n\");\n            throw new Error(\n                `Storage client configuration validation failed:\\n${errorMessages}`\n            );\n        }\n        throw error;\n    }\n}\n","import { Memory } from '@elizaos/core';\nimport { CID } from 'multiformats/cid';\nimport { CarReader } from '@ipld/car';\nimport { importDAG } from '@ucanto/core/delegation';\n\nexport const defaultGatewayUrl = \"https://w3s.link\";\n\nexport const getCIDsFromMessage = (message: Memory) => {\n    if (!message?.content?.text) {\n        return [];\n    }\n\n    // Patterns for potential CIDs:\n    // - v0 CIDs start with Qm and are 46 characters in base58\n    // - v1 CIDs commonly start with b for various base encodings (often bafy, bafk, etc.)\n    const cidPattern = /(Qm[a-zA-Z0-9]{44}|b[a-zA-Z0-9]{1,})/g;\n    const matches = message.content.text.match(cidPattern);\n    const cids: string[] = [];\n    \n    if (matches) {\n        for (const match of matches) {\n            try {\n                const cid = CID.parse(match);\n                // Accept both v0 and v1 CIDs\n                if (cid.version === 0 || cid.version === 1) {\n                    cids.push(cid.toString());\n                }\n            } catch (error) {\n                // We can ignore this error as it's not a valid CID\n            }\n        }\n    }\n    return cids;\n}\n\n\n/**\n * Parses a delegation from a base64 encoded CAR file\n * @param data - The base64 encoded CAR file\n * @returns The parsed delegation\n */\nexport const parseDelegation = async (data: string) => {\n    const blocks = []\n    const reader = await CarReader.fromBytes(Buffer.from(data, 'base64'))\n    for await (const block of reader.blocks()) {\n        blocks.push(block)\n    }\n    return importDAG(blocks)\n}\n","import * as Storage from '@web3-storage/w3up-client';\nimport { Client, IAgentRuntime, ClientInstance, elizaLogger } from \"@elizaos/core\";\nimport { StoreMemory } from '@web3-storage/w3up-client/stores/memory';\nimport { Signer } from '@ucanto/principal/ed25519';\nimport { StorageClientConfig, validateStorageClientConfig } from \"../environments\";\nimport { defaultGatewayUrl, parseDelegation } from '../utils';\n\nexport class StorageClientInstanceImpl implements ClientInstance {\n    private readonly runtime: IAgentRuntime;\n    private storage: Storage.Client | null = null;\n    config: StorageClientConfig | null = null;\n\n    constructor(runtime: IAgentRuntime) {\n        this.runtime = runtime;\n    }\n\n    async start(): Promise<void> {\n        try {\n            if (this.storage) {\n                elizaLogger.info(\"Storage client already initialized\");\n                return;\n            }\n            this.config = await validateStorageClientConfig(this.runtime);\n            this.storage = await createStorageClient(this.config);\n            elizaLogger.success(`✅ Storage client successfully started`);\n        } catch (error) {\n            elizaLogger.error(`❌ Storage client failed to start: ${error}`);\n            throw error;\n        }\n    }\n\n    async stop(runtime?: IAgentRuntime): Promise<void> {\n        this.storage = null;\n        this.config = null;\n    }\n\n    getStorage() {\n        if (!this.storage) {\n            throw new Error(\"Storage client not initialized\");\n        }\n        return this.storage;\n    }\n\n    getConfig() {\n        if (!this.config) {\n            throw new Error(\"Storage client not initialized\");\n        }\n        return this.config;\n    }\n\n    getGatewayUrl(): string {\n        return this.config?.GATEWAY_URL || defaultGatewayUrl;\n    }\n\n    getContent(cid: string): Promise<Response> {\n        return fetch(`${this.getGatewayUrl()}/ipfs/${cid}`);\n    }\n}\n\nexport const StorageClientInterface: Client = {\n    name: 'storage',\n    start: async (runtime: IAgentRuntime): Promise<ClientInstance> => {\n        const storageClient = new StorageClientInstanceImpl(runtime);\n        await storageClient.start();\n        return storageClient;\n    }\n};\n\nexport const createStorageClient = async (config: StorageClientConfig): Promise<Storage.Client> => {\n    if (!config.STORACHA_AGENT_PRIVATE_KEY) {\n        throw new Error(\"Agent private key is missing from the storage client configuration\");\n    }\n    if (!config.STORACHA_AGENT_DELEGATION) {\n        throw new Error(\"Agent delegation is missing from the storage client configuration\");\n    }\n\n    const principal = Signer.parse(config.STORACHA_AGENT_PRIVATE_KEY);\n    const store = new StoreMemory();\n    const client = await Storage.create({ principal, store });\n\n    const delegationProof = await parseDelegation(config.STORACHA_AGENT_DELEGATION);\n    const space = await client.addSpace(delegationProof);\n    await client.setCurrentSpace(space.did());\n    console.log(`Storage client initialized`);\n\n    return client;\n}\n","import {\n    type Action,\n    type ActionExample,\n    type HandlerCallback,\n    type IAgentRuntime,\n    type Memory,\n    type State,\n    elizaLogger,\n} from \"@elizaos/core\";\nimport { validateStorageClientConfig } from \"../environments\";\nimport { defaultGatewayUrl, getCIDsFromMessage } from \"../utils\";\n\nexport const retrieveAction: Action = {\n    name: \"STORAGE_RETRIEVE\",\n    similes: [\n        \"RETRIEVE\",\n        \"RETRIEVE_FILE\",\n        \"RETRIEVE_FILE_FROM_STORAGE\",\n        \"RETRIEVE_FILE_FROM_IPFS\",\n        \"GET\",\n        \"GET_FILE\",\n        \"GET_FILE_FROM_STORAGE\",\n        \"GET_FILE_FROM_IPFS\",\n        \"GET_FILE_FROM_CID\",\n        \"LOAD\",\n        \"LOAD_FILE\",\n        \"LOAD_FILE_FROM_STORAGE\",\n        \"LOAD_FILE_FROM_IPFS\",\n        \"LOAD_FILE_FROM_CID\",\n        \"READ\",\n        \"READ_FILE\",\n        \"READ_FILE_FROM_STORAGE\",\n        \"READ_FILE_FROM_IPFS\",\n        \"READ_FILE_FROM_CID\",\n    ],\n    validate: async (runtime: IAgentRuntime, _message: Memory) => {\n        elizaLogger.log(\"Starting STORAGE_RETRIEVE validate...\");\n        await validateStorageClientConfig(runtime);\n        return true;\n    },\n    description:\n        \"Retrieve a file from the Storacha network. Use this action when a user asks you to retrieve a file from the Storacha network based on a CID.\",\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State,\n        _options: { [key: string]: unknown },\n        callback?: HandlerCallback\n    ): Promise<boolean> => {\n        elizaLogger.log(\"Starting STORAGE_RETRIEVE handler...\");\n        const cids = getCIDsFromMessage(message);\n        if (cids.length === 0) {\n            await callback?.({ text: \"You didn't provide any CIDs to retrieve the content.\" });\n            return false;\n        }\n\n        const config = await validateStorageClientConfig(runtime);\n\n        try {\n            elizaLogger.log(\"Retrieving file(s) from storage...\");\n            const gatewayUrl = config.GATEWAY_URL || defaultGatewayUrl;\n            // TODO: download, zip and send the zip as an attachment in the message\n            const files = cids.map((cid, idx) => {\n                return {\n                    url: `${gatewayUrl}/ipfs/${cid}`,\n                    title: `File ${idx + 1}`,\n                };\n            });\n            await callback?.({\n                text: `The file(s) you requested are ready to be downloaded. \\n\\n${files.map((file) => `- ${file.url}`).join(\"\\n\")}`,\n            });\n            elizaLogger.log(\"File(s) retrieved successfully!\");\n            return true;\n        } catch (error) {\n            elizaLogger.error(\"Error during retrieve file(s) from storage:\", error);\n            await callback?.({ text: `Error during retrieve file(s) from storage: ${error.message}` });\n            return false;\n        }\n    },\n    examples: [\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Retrieve the file with CID: QmS4ghgMgfFvqPjB4WKXHaN15ZyT4K4JY8Y4K3Y4K3Y4K3Y\",\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: \"Ok, I'll get it for you. Just a moment...\",\n                },\n            },\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Fetch the file QmS4ghgMgfFvqPjB4WKXHaN15ZyT4K4JY8Y4K3Y4K3Y4K3Y\",\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: \"Ok, I'll get it for you. Just a second...\",\n                },\n            },\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Get the file QmS4ghgMgfFvqPjB4WKXHaN15ZyT4K4JY8Y4K3Y4K3Y4K3Y\",\n                },\n            },\n            {\n                user: \"{{agent}}\",\n                content: {\n                    text: \"Ok, I'll get it for you. Hold on...\",\n                },\n            },\n        ],\n    ] as ActionExample[][],\n} as Action;\n","import type { ClientInstance, IAgentRuntime, Plugin } from \"@elizaos/core\";\nimport { uploadAction, retrieveAction } from \"./actions\";\nimport { storageClientEnvSchema } from \"./environments.ts\";\nimport { StorageClientInstanceImpl, StorageClientInterface } from \"./clients/storage.ts\";\nimport * as Storage from '@web3-storage/w3up-client';\nexport { StorageClientInterface, StorageClientInstanceImpl as StorageClientImpl } from \"./clients/storage.ts\";\n\n\nconst PluginName = \"storage\";\n\nexport const storagePlugin: Plugin = {\n    name: PluginName,\n    description: \"Plugin to manage files in a decentralized storage network\",\n    config: storageClientEnvSchema,\n    actions: [uploadAction, retrieveAction],\n    clients: [StorageClientInterface],\n    services: [],\n    evaluators: [],\n    providers: [],\n};\n\nexport const getStorageClient = async (runtime: IAgentRuntime): Promise<StorageClientInstanceImpl> => {\n    const storagePlugin = runtime.plugins.find((plugin) => plugin.name === PluginName);\n    if (storagePlugin && storagePlugin.clients && storagePlugin.clients.length > 0) {\n        const storageStarter = storagePlugin.clients[0];\n        if (storageStarter) {\n            const storageClient = await storageStarter.start(runtime);\n            return storageClient as StorageClientInstanceImpl;\n        }\n    }\n    throw new Error(\"Storage client not found in runtime\");\n}\n\nexport default storagePlugin;\n\n"],"mappings":"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","names":["elizaLogger","elizaLogger","elizaLogger","elizaLogger","elizaLogger","elizaLogger","storagePlugin"]}